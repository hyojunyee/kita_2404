<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaflet 한국 지도 예제</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <style>
        #map {
            height: 600px;
        }
        .legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background-color: white;
            padding: 10px;
            border: 1px solid #ccc;
            font-size: 12px;
        }
        .legend-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .legend-item {
            margin-bottom: 3px;
        }
        .legend-color {
            display: inline-block;
            width: 15px;
            height: 15px;
            margin-right: 5px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <div class="legend">
        <div class="legend-title">인구 수 범례</div>
        <div class="legend-item"><span class="legend-color" style="background-color: #b10026;"></span> 5,000,000 이상</div>
        <div class="legend-item"><span class="legend-color" style="background-color: #e31a1c;"></span> 3,000,000 - 5,000,000</div>
        <div class="legend-item"><span class="legend-color" style="background-color: #fc4e2a;"></span> 2,000,000 - 3,000,000</div>
        <div class="legend-item"><span class="legend-color" style="background-color: #fd8d3c;"></span> 1,800,000 - 2,000,000</div>
        <div class="legend-item"><span class="legend-color" style="background-color: #feb24c;"></span> 1,600,000 - 1,800,000</div>
        <div class="legend-item"><span class="legend-color" style="background-color: #fed976;"></span> 1,400,000 - 1,600,000</div>
        <div class="legend-item"><span class="legend-color" style="background-color: #ffeda0;"></span> 1,200,000 - 1,400,000</div>
        <div class="legend-item"><span class="legend-color" style="background-color: #ffffcc;"></span> 1,000,000 - 1,200,000</div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        var map = L.map('map').setView([37.5665, 126.9780], 11); // 서울의 중심 좌표로 초기화

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        var markers = []; // 마커를 담을 배열

        // 서울의 각 구의 중심 좌표 및 이름
        var seoulDistricts = [
            { name: '강남구', center: [37.5172, 127.0473] },
            { name: '강동구', center: [37.5301, 127.1238] },
            { name: '강서구', center: [37.5658, 126.8225] },
            { name: '관악구', center: [37.4784, 126.9516] },
            { name: '광진구', center: [37.5420, 127.0838] },
            { name: '구로구', center: [37.4954, 126.8874] },
            { name: '금천구', center: [37.4601, 126.9000] },
            { name: '노원구', center: [37.6552, 127.0773] },
            { name: '도봉구', center: [37.6688, 127.0471] },
            { name: '동대문구', center: [37.5744, 127.0396] },
            { name: '동작구', center: [37.5125, 126.9395] },
            { name: '마포구', center: [37.5665, 126.9010] },
            { name: '서대문구', center: [37.5791, 126.9368] },
            { name: '서초구', center: [37.4837, 127.0324] },
            { name: '성동구', center: [37.5635, 127.0365] },
            { name: '성북구', center: [37.6065, 127.0276] },
            { name: '송파구', center: [37.5145, 127.1070] },
            { name: '양천구', center: [37.5270, 126.8560] },
            { name: '영등포구', center: [37.5208, 126.9134] },
            { name: '용산구', center: [37.5327, 126.9904] },
            { name: '은평구', center: [37.6176, 126.9227] },
            { name: '종로구', center: [37.5720, 126.9840] },
            { name: '중구', center: [37.5639, 126.9975] },
            { name: '중랑구', center: [37.6065, 127.0927] }
        ];

        // 각 구의 마커 생성 및 이벤트 처리
        seoulDistricts.forEach(district => {
            var marker = L.marker(district.center, {
                opacity: 1 // 초기에는 모든 마커를 보이게 설정
            }).addTo(map);
            marker.bindPopup('<b>' + district.name + '</b>');
            markers.push(marker);
        });

        // 지도 줌 레벨에 따라 마커 숨기기
        map.on('zoomend', function() {
            var currentZoom = map.getZoom();
            if (currentZoom < 12) { // 예시로 12 레벨 이하일 때 마커를 숨깁니다.
                markers.forEach(marker => {
                    marker.setOpacity(0); // 줌 레벨이 낮으면 마커 숨기기
                });
            } else {
                markers.forEach(marker => {
                    marker.setOpacity(1); // 줌 레벨이 높으면 마커 보이기
                });
            }
        });

        // 인구 수에 따라 색상 결정하기
        function getColor(population) {
            return population > 5000000 ? '#b10026' :
                   population > 3000000 ? '#e31a1c' :
                   population > 2000000 ? '#fc4e2a' :
                   population > 1800000 ? '#fd8d3c' :
                   population > 1600000 ? '#feb24c' :
                   population > 1400000 ? '#fed976' :
                   population > 1200000 ? '#ffeda0' :
                   population > 1000000 ? '#ffffcc' :
                                           '#ffffff'; // 최소 인구수에 대한 색상
        }
    </script>
</body>
</html>
